<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Form view: smart buttons + section Fleet -->
        <record id="view_partner_form_inherit_fleet_partner" model="ir.ui.view">
            <field name="name">res.partner.form.fleet.partner.network</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <xpath expr="//div[@name='button_box']" position="inside">
                    <button name="action_view_fleet_partner_profiles"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-sitemap"
                            groups="custom_fleet_partner_network.group_fleet_partner_user,custom_fleet_partner_network.group_fleet_partner_manager"
                            invisible="fleet_partner_profile_count == 0">
                        <field name="fleet_partner_profile_count" widget="statinfo" string="Profils Fleet"/>
                    </button>
                    <button name="action_create_fleet_partner_profile"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-plus"
                            string="Créer un profil Fleet"
                            groups="custom_fleet_partner_network.group_fleet_partner_manager"/>
                </xpath>
                <xpath expr="//group[@name='supplier_approval']" position="after">
                    <group string="Références Parc Auto" name="fleet_partner_reference_group">
                        <group>
                            <field name="fleet_partner_reference" readonly="1" invisible="fleet_partner_profile_count == 0"/>
                            <field name="fleet_partner_contact_id" readonly="1" invisible="fleet_partner_profile_count == 0"/>
                        </group>
                    </group>
                </xpath>
            </field>
        </record>

    </data>
</odoo>
