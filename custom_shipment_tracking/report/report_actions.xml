<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ========================================== -->
    <!-- REPORT ACTION - Single Parcel Label       -->
    <!-- ========================================== -->
    <record id="action_report_parcel_label" model="ir.actions.report">
        <field name="name">Étiquette colis</field>
        <field name="model">shipment.parcel</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_shipment_tracking.report_parcel_label</field>
        <field name="report_file">custom_shipment_tracking.report_parcel_label</field>
        <field name="print_report_name">'Etiquette_Colis_%s' % object.name.replace('/', '_')</field>
        <field name="binding_model_id" ref="model_shipment_parcel"/>
        <field name="binding_type">report</field>
    </record>


    <!-- ========================================== -->
    <!-- REPORT PAPERFORMAT - A6 Label Format      -->
    <!-- ========================================== -->
    <record id="paperformat_parcel_label" model="report.paperformat">
        <field name="name">Format étiquette colis (A6)</field>
        <field name="default" eval="False"/>
        <field name="format">custom</field>
        <field name="page_width">105</field>
        <field name="page_height">148</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">5</field>
        <field name="margin_bottom">5</field>
        <field name="margin_left">5</field>
        <field name="margin_right">5</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="dpi">96</field>
    </record>


    <!-- ========================================== -->
    <!-- REPORT PAPERFORMAT - Proforma A4 Format   -->
    <!-- (Must be defined BEFORE the report action)-->
    <!-- ========================================== -->
    <record id="paperformat_proforma_invoice" model="report.paperformat">
        <field name="name">Format Facture Proforma (A4)</field>
        <field name="default" eval="False"/>
        <field name="format">custom</field>
        <field name="page_width">210</field>
        <field name="page_height">297</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">6</field>
        <field name="margin_bottom">45</field>
        <field name="margin_left">5</field>
        <field name="margin_right">5</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="dpi">96</field>
    </record>

    <!-- ========================================== -->
    <!-- REPORT PAPERFORMAT - Cargo with Header    -->
    <!-- (Larger header spacing for cargo reports) -->
    <!-- ========================================== -->
    <record id="paperformat_proforma_cargo" model="report.paperformat">
        <field name="name">Format Facture Proforma Cargo (A4)</field>
        <field name="default" eval="False"/>
        <field name="format">custom</field>
        <field name="page_width">210</field>
        <field name="page_height">297</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">15</field>
        <field name="margin_bottom">25</field>
        <field name="margin_left">10</field>
        <field name="margin_right">10</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">5</field>
        <field name="dpi">96</field>
    </record>


    <!-- ========================================== -->
    <!-- REPORT ACTION - Proforma Invoice (ICARE)  -->
    <!-- (Style ICARE Voyages / FACTURE PRO AGILLY)-->
    <!-- For Sale Orders - report definition only  -->
    <!-- ========================================== -->
    <record id="action_report_sale_order_proforma_invoice" model="ir.actions.report">
        <field name="name">Facture Proforma (ICARE GROUPE)</field>
        <field name="model">sale.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_shipment_tracking.report_sale_order_proforma_invoice</field>
        <field name="report_file">custom_shipment_tracking.report_sale_order_proforma_invoice</field>
        <field name="print_report_name">'Proforma_%s' % object.name.replace('/', '_')</field>
        <field name="binding_model_id" eval="False"/>
        <field name="paperformat_id" ref="paperformat_proforma_invoice"/>
    </record>

    <!-- Server Action to print ICARE Proforma - shows only when active company is NOT MYRED -->
    <record id="action_server_print_proforma_icare" model="ir.actions.server">
        <field name="name">Facture Proforma (ICARE GROUPE)</field>
        <field name="model_id" ref="sale.model_sale_order"/>
        <field name="binding_model_id" ref="sale.model_sale_order"/>
        <field name="binding_type">report</field>
        <field name="binding_view_types">form,list</field>
        <field name="state">code</field>
        <field name="code">
# Only show for non-MYRED active company (company switcher)
if records and 'myred' not in (env.company.name or '').lower():
    action = env.ref('custom_shipment_tracking.action_report_sale_order_proforma_invoice').report_action(records)
else:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>


    <!-- ========================================== -->
    <!-- REPORT ACTION - Proforma Invoice MYRED    -->
    <!-- (Style MYRED TRAVELS branding)            -->
    <!-- For Sale Orders - report definition only  -->
    <!-- ========================================== -->
    <record id="action_report_sale_order_proforma_myred" model="ir.actions.report">
        <field name="name">Facture Proforma (MYRED TRAVELS)</field>
        <field name="model">sale.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_shipment_tracking.report_sale_order_proforma_myred</field>
        <field name="report_file">custom_shipment_tracking.report_sale_order_proforma_myred</field>
        <field name="print_report_name">'Proforma_MYRED_%s' % object.name.replace('/', '_')</field>
        <field name="binding_model_id" eval="False"/>
        <field name="paperformat_id" ref="paperformat_proforma_invoice"/>
    </record>

    <!-- Server Action to print MYRED Proforma - shows only when active company is MYRED -->
    <record id="action_server_print_proforma_myred" model="ir.actions.server">
        <field name="name">Facture Proforma (MYRED TRAVELS)</field>
        <field name="model_id" ref="sale.model_sale_order"/>
        <field name="binding_model_id" ref="sale.model_sale_order"/>
        <field name="binding_type">report</field>
        <field name="binding_view_types">form,list</field>
        <field name="state">code</field>
        <field name="code">
# Only show for MYRED TRAVELS active company (company switcher)
if records and 'myred' in (env.company.name or '').lower():
    action = env.ref('custom_shipment_tracking.action_report_sale_order_proforma_myred').report_action(records)
else:
    action = {'type': 'ir.actions.act_window_close'}
        </field>
    </record>


    <!-- ========================================== -->
    <!-- REPORT ACTIONS - SHIPMENT REQUEST         -->
    <!-- Proforma Cargo (Fret) + Colisage (Groupage)-->
    <!-- ========================================== -->
    
    <!-- REPORT ACTION - Proforma Invoice ICARE CARGO (Fret) -->
    <record id="action_report_shipment_proforma_cargo" model="ir.actions.report">
        <field name="name">Facture Proforma ICARE CARGO (Fret)</field>
        <field name="model">shipment.request</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_shipment_tracking.report_shipment_proforma_cargo</field>
        <field name="report_file">custom_shipment_tracking.report_shipment_proforma_cargo</field>
        <field name="print_report_name">'Proforma_Cargo_%s' % object.name.replace('/', '_')</field>
        <field name="binding_model_id" eval="False"/>
        <field name="paperformat_id" ref="paperformat_proforma_cargo"/>
    </record>

    <!-- REPORT ACTION - Liste de Colisage (Groupage) -->
    <record id="action_report_shipment_colisage" model="ir.actions.report">
        <field name="name">Liste de Colisage (Groupage)</field>
        <field name="model">shipment.request</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_shipment_tracking.report_shipment_colisage</field>
        <field name="report_file">custom_shipment_tracking.report_shipment_colisage</field>
        <field name="print_report_name">'Colisage_%s' % object.name.replace('/', '_')</field>
        <field name="binding_model_id" eval="False"/>
        <field name="paperformat_id" ref="paperformat_proforma_invoice"/>
    </record>

</odoo>
